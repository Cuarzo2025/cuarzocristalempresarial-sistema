<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | Cuarzo Cristal</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #FFFFFF; 
            --bg: #0A0A0A; 
            --card: #141414; 
            --text-dim: #A0A0A0; 
            --accent: #4CAF50; 
            --border: #333; 
        }

        body { 
            background: var(--bg); 
            color: var(--primary); 
            font-family: 'Montserrat', sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
        }

        .container { 
            background: var(--card); 
            padding: 40px; 
            border-radius: 16px; 
            width: 100%; 
            max-width: 350px; 
            border: 1px solid var(--border); 
            text-align: center; 
        }

        h1 { 
            font-weight: 800; 
            margin: 0; 
            letter-spacing: -1px; 
            text-transform: uppercase;
        }

        .subtitle { 
            color: var(--text-dim); 
            font-size: 0.9rem; 
            margin-bottom: 30px; 
            margin-top: 10px;
        }

        input { 
            width: 100%; 
            padding: 14px; 
            margin-bottom: 15px; 
            background: #1e1e1e; 
            border: 1px solid var(--border); 
            border-radius: 8px; 
            color: white; 
            box-sizing: border-box; 
            font-family: inherit;
        }

        input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .btn-main { 
            width: 100%; 
            padding: 16px; 
            background: var(--primary); 
            color: black; 
            border: none; 
            border-radius: 8px; 
            font-weight: 700; 
            cursor: pointer; 
            text-transform: uppercase; 
            transition: 0.3s;
            margin-top: 10px;
        }

        .btn-main:hover { 
            opacity: 0.8; 
            transform: translateY(-2px); 
        }

        .loader {
            display: none;
            margin: 10px auto;
            border: 3px solid #333;
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        a { 
            color: var(--accent); 
            text-decoration: none; 
            font-size: 0.85rem; 
            display: block;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>CUARZO</h1>
        <p class="subtitle">Portal de Colaboradores</p>
        
        <form id="login-form">
            <input type="email" id="login-email" placeholder="Correo electrónico" required>
            <input type="password" id="login-pass" placeholder="Contraseña" required>
            <div id="loader" class="loader"></div>
            <button type="submit" id="btn-text" class="btn-main">Entrar</button>
        </form>

        <a href="index.html">¿No tienes cuenta? Regístrate aquí</a>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCW3_c7c4wNs6mUgX0EFp40SnjBx-WfLNI",
            authDomain: "cuarzocristalempresarialsist.firebaseapp.com",
            projectId: "cuarzocristalempresarialsist",
            storageBucket: "cuarzocristalempresarialsist.firebasestorage.app",
            messagingSenderId: "1031610061736",
            appId: "1:1031610061736:web:d05d431b433eb5b55ec39d"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-pass').value;
            const btn = document.getElementById('btn-text');
            const loader = document.getElementById('loader');
            
            // UI State
            btn.style.display = 'none';
            loader.style.display = 'block';

            try {
                const userCred = await signInWithEmailAndPassword(auth, email, pass);
                
                // NOTA: Si quieres obligar a verificar el email antes de entrar, 
                // descomenta las siguientes líneas. Si no, entrará directo con la clave temporal.
                
                /*
                if (!userCred.user.emailVerified) {
                    alert("Por favor, verifica tu correo electrónico antes de ingresar.");
                    btn.style.display = 'block';
                    loader.style.display = 'none';
                    return;
                }
                */

                // Si llegamos aquí, login exitoso
                window.location.href = "dashboard.html";

            } catch (error) { 
                console.error(error.code);
                let mensaje = "Error al ingresar. Verifica tus datos.";
                
                if(error.code === 'auth/invalid-credential') mensaje = "Correo o contraseña incorrectos.";
                if(error.code === 'auth/user-not-found') mensaje = "El usuario no existe.";
                
                alert(mensaje);
                btn.style.display = 'block';
                loader.style.display = 'none';
            }
        });
    </script>
</body>
</html>